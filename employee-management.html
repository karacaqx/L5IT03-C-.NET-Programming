<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Employee Management - Employee Management System</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }

        .search-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .employee-details {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .employee-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        
        .info-label {
            font-weight: 600;
            color: #6c757d;
            margin-bottom: 0.25rem;
        }
        
        .info-value {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: #f8f9fa;
            border-radius: 0.375rem;
        }
        
        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 600;
        }
        
        .status-active {
            background: #d1e7dd;
            color: #0a3622;
        }
        
        .status-inactive {
            background: #f8d7da;
            color: #58151c;
        }

        .fade-in {
            animation: fadeIn 0.8s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Department Themes */
        .theme-hr { --primary: #198754; --primary-dark: #157347; }
        .theme-it { --primary: #6f42c1; --primary-dark: #5a32a3; }
        .theme-finance { --primary: #fd7e14; --primary-dark: #e8590c; }
        .theme-marketing { --primary: #d63384; --primary-dark: #b02a5b; }
        .theme-default { --primary: #0d6efd; --primary-dark: #0b5ed7; }

        .themed .navbar { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%) !important; }
        .themed .btn-primary { background: var(--primary); border-color: var(--primary); }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="dashboard.html">
                <i class="fas fa-users me-2"></i>Employee Management
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="dashboard.html">
                            <i class="fas fa-home me-1"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="employee-management.html">
                            <i class="fas fa-user-edit me-1"></i>Employee Management
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user me-1"></i>
                            <span id="userFullName">User</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="changeTheme()">
                                <i class="fas fa-palette me-1"></i>Change Theme
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" onclick="logout()">
                                <i class="fas fa-sign-out-alt me-1"></i>Logout
                            </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
        <div class="fade-in">
            <!-- Page Header -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>
                    <i class="fas fa-users-cog me-2"></i>Employee Management
                </h2>
                <button class="btn btn-outline-secondary" onclick="window.location.href='dashboard.html'">
                    <i class="fas fa-arrow-left me-1"></i>Back to Dashboard
                </button>
            </div>

            <!-- Search Section -->
            <div class="search-section">
                <h4 class="mb-4">
                    <i class="fas fa-search me-2"></i>Search Employee
                </h4>
                
                <div class="row">
                    <div class="col-md-8">
                        <div class="input-group">
                            <span class="input-group-text">
                                <i class="fas fa-id-badge"></i>
                            </span>
                            <input type="text" id="txtSearchEmployeeId" class="form-control" 
                                   placeholder="Enter Employee ID (e.g., EMP001)" maxlength="20">
                            <button class="btn btn-primary" onclick="searchEmployee()">
                                <i class="fas fa-search me-1"></i>Search
                            </button>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-outline-secondary w-100" onclick="clearSearch()">
                            <i class="fas fa-times me-1"></i>Clear
                        </button>
                    </div>
                </div>
                
                <div id="searchMessage" class="alert mt-3" style="display: none;">
                    <span id="searchMessageText"></span>
                </div>
            </div>

            <!-- Employee Details Section -->
            <div id="employeeDetails" class="employee-details" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h4>
                        <i class="fas fa-user me-2"></i>Employee Details
                    </h4>
                    <div>
                        <button id="btnEdit" class="btn btn-warning me-2" onclick="toggleEditMode()">
                            <i class="fas fa-edit me-1"></i>Edit
                        </button>
                        <button id="btnSave" class="btn btn-success me-2" onclick="saveEmployee()" style="display: none;">
                            <i class="fas fa-save me-1"></i>Save
                        </button>
                        <button id="btnCancel" class="btn btn-secondary" onclick="cancelEdit()" style="display: none;">
                            <i class="fas fa-times me-1"></i>Cancel
                        </button>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-3 text-center">
                        <div class="employee-avatar mx-auto" id="employeeAvatar">
                            JD
                        </div>
                        <div id="employeeStatus" class="status-badge status-active">
                            Active
                        </div>
                    </div>
                    
                    <div class="col-md-9">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="info-label">Employee ID</div>
                                <div class="info-value" id="employeeId">EMP001</div>
                                
                                <div class="info-label">First Name</div>
                                <div class="info-value">
                                    <span id="firstNameDisplay">John</span>
                                    <input type="text" id="firstNameEdit" class="form-control" style="display: none;">
                                </div>
                                
                                <div class="info-label">Last Name</div>
                                <div class="info-value">
                                    <span id="lastNameDisplay">Doe</span>
                                    <input type="text" id="lastNameEdit" class="form-control" style="display: none;">
                                </div>
                                
                                <div class="info-label">Email</div>
                                <div class="info-value">
                                    <span id="emailDisplay">john.doe@company.com</span>
                                    <input type="email" id="emailEdit" class="form-control" style="display: none;">
                                </div>
                                
                                <div class="info-label">Phone</div>
                                <div class="info-value">
                                    <span id="phoneDisplay">+1-555-0123</span>
                                    <input type="tel" id="phoneEdit" class="form-control" style="display: none;">
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="info-label">Department</div>
                                <div class="info-value">
                                    <span id="departmentDisplay">HR</span>
                                    <select id="departmentEdit" class="form-select" style="display: none;">
                                        <option value="HR">Human Resources</option>
                                        <option value="IT">Information Technology</option>
                                        <option value="Finance">Finance</option>
                                        <option value="Marketing">Marketing</option>
                                    </select>
                                </div>
                                
                                <div class="info-label">Position</div>
                                <div class="info-value">
                                    <span id="positionDisplay">HR Manager</span>
                                    <input type="text" id="positionEdit" class="form-control" style="display: none;">
                                </div>
                                
                                <div class="info-label">Salary</div>
                                <div class="info-value">
                                    <span id="salaryDisplay">$75,000</span>
                                    <input type="number" id="salaryEdit" class="form-control" style="display: none;">
                                </div>
                                
                                <div class="info-label">Hire Date</div>
                                <div class="info-value">
                                    <span id="hireDateDisplay">Jan 15, 2022</span>
                                    <input type="date" id="hireDateEdit" class="form-control" style="display: none;">
                                </div>
                                
                                <div class="info-label">Status</div>
                                <div class="info-value">
                                    <input type="checkbox" id="statusEdit" class="form-check-input me-2" style="display: none;">
                                    <label for="statusEdit" id="statusLabel" style="display: none;">Active Employee</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Update Message -->
            <div id="updateMessage" class="alert" style="display: none;">
                <span id="updateMessageText"></span>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Sample employee data
        const employees = [
            {
                employeeId: "EMP001",
                firstName: "John",
                lastName: "Doe",
                email: "john.doe@company.com",
                phone: "+1-555-0123",
                department: "HR",
                position: "HR Manager",
                salary: 75000,
                hireDate: "2022-01-15",
                isActive: true
            },
            {
                employeeId: "EMP002",
                firstName: "Jane",
                lastName: "Smith",
                email: "jane.smith@company.com",
                phone: "+1-555-0124",
                department: "IT",
                position: "Software Developer",
                salary: 85000,
                hireDate: "2021-03-22",
                isActive: true
            },
            {
                employeeId: "EMP003",
                firstName: "Mike",
                lastName: "Johnson",
                email: "mike.johnson@company.com",
                phone: "+1-555-0125",
                department: "Finance",
                position: "Financial Analyst",
                salary: 70000,
                hireDate: "2022-07-10",
                isActive: true
            },
            {
                employeeId: "EMP004",
                firstName: "Sarah",
                lastName: "Wilson",
                email: "sarah.wilson@company.com",
                phone: "+1-555-0126",
                department: "Marketing",
                position: "Marketing Specialist",
                salary: 65000,
                hireDate: "2023-02-14",
                isActive: true
            },
            {
                employeeId: "EMP005",
                firstName: "David",
                lastName: "Brown",
                email: "david.brown@company.com",
                phone: "+1-555-0127",
                department: "IT",
                position: "System Administrator",
                salary: 80000,
                hireDate: "2021-11-30",
                isActive: true
            }
        ];

        let currentEmployee = null;
        let isEditMode = false;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            
            if (!currentUser) {
                window.location.href = 'index.html';
                return;
            }

            // Set user info
            document.getElementById('userFullName').textContent = currentUser.fullName;

            // Apply theme
            applyTheme(currentUser.department);

            // Check for employee ID in URL
            const urlParams = new URLSearchParams(window.location.search);
            const employeeId = urlParams.get('id');
            if (employeeId) {
                document.getElementById('txtSearchEmployeeId').value = employeeId;
                searchEmployee();
            }

            // Auto-focus search box
            document.getElementById('txtSearchEmployeeId').focus();
        });

        function applyTheme(department) {
            const body = document.body;
            body.className = 'themed theme-' + department.toLowerCase();
        }

        function searchEmployee() {
            const employeeId = document.getElementById('txtSearchEmployeeId').value.trim();
            
            if (!employeeId) {
                showSearchMessage('Please enter an Employee ID.', 'warning');
                return;
            }

            const employee = employees.find(emp => emp.employeeId.toUpperCase() === employeeId.toUpperCase());
            
            if (employee) {
                currentEmployee = employee;
                displayEmployee(employee);
                document.getElementById('employeeDetails').style.display = 'block';
                hideSearchMessage();
            } else {
                showSearchMessage('Employee not found. Please check the Employee ID and try again.', 'danger');
                document.getElementById('employeeDetails').style.display = 'none';
            }
        }

        function displayEmployee(employee) {
            // Basic Information
            document.getElementById('employeeId').textContent = employee.employeeId;
            document.getElementById('firstNameDisplay').textContent = employee.firstName;
            document.getElementById('lastNameDisplay').textContent = employee.lastName;
            document.getElementById('emailDisplay').textContent = employee.email;
            document.getElementById('phoneDisplay').textContent = employee.phone;
            document.getElementById('departmentDisplay').textContent = employee.department;
            document.getElementById('positionDisplay').textContent = employee.position;
            document.getElementById('salaryDisplay').textContent = '$' + employee.salary.toLocaleString();
            document.getElementById('hireDateDisplay').textContent = new Date(employee.hireDate).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });

            // Set edit form values
            document.getElementById('firstNameEdit').value = employee.firstName;
            document.getElementById('lastNameEdit').value = employee.lastName;
            document.getElementById('emailEdit').value = employee.email;
            document.getElementById('phoneEdit').value = employee.phone;
            document.getElementById('departmentEdit').value = employee.department;
            document.getElementById('positionEdit').value = employee.position;
            document.getElementById('salaryEdit').value = employee.salary;
            document.getElementById('hireDateEdit').value = employee.hireDate;
            document.getElementById('statusEdit').checked = employee.isActive;

            // Status
            const statusElement = document.getElementById('employeeStatus');
            if (employee.isActive) {
                statusElement.textContent = 'Active';
                statusElement.className = 'status-badge status-active';
            } else {
                statusElement.textContent = 'Inactive';
                statusElement.className = 'status-badge status-inactive';
            }

            // Employee initials for avatar
            const initials = (employee.firstName[0] || '') + (employee.lastName[0] || '');
            document.getElementById('employeeAvatar').textContent = initials.toUpperCase();

            // Reset edit mode
            setEditMode(false);
        }

        function toggleEditMode() {
            if (!currentEmployee) return;

            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            
            // Check if user can edit this employee (same department or admin privileges)
            if (currentUser.department !== currentEmployee.department && currentUser.username !== 'aliriza') {
                showUpdateMessage('You can only edit employees from your department.', 'warning');
                return;
            }

            setEditMode(true);
        }

        function setEditMode(editMode) {
            isEditMode = editMode;

            // Toggle display elements
            const displayElements = ['firstNameDisplay', 'lastNameDisplay', 'emailDisplay', 
                                   'phoneDisplay', 'departmentDisplay', 'positionDisplay', 
                                   'salaryDisplay', 'hireDateDisplay'];
            
            const editElements = ['firstNameEdit', 'lastNameEdit', 'emailEdit', 
                                'phoneEdit', 'departmentEdit', 'positionEdit', 
                                'salaryEdit', 'hireDateEdit', 'statusEdit', 'statusLabel'];

            displayElements.forEach(id => {
                document.getElementById(id).style.display = editMode ? 'none' : 'block';
            });

            editElements.forEach(id => {
                document.getElementById(id).style.display = editMode ? 'block' : 'none';
            });

            // Toggle buttons
            document.getElementById('btnEdit').style.display = editMode ? 'none' : 'inline-block';
            document.getElementById('btnSave').style.display = editMode ? 'inline-block' : 'none';
            document.getElementById('btnCancel').style.display = editMode ? 'inline-block' : 'none';
        }

        function saveEmployee() {
            if (!validateInput()) return;

            // Update employee object
            currentEmployee.firstName = document.getElementById('firstNameEdit').value.trim();
            currentEmployee.lastName = document.getElementById('lastNameEdit').value.trim();
            currentEmployee.email = document.getElementById('emailEdit').value.trim();
            currentEmployee.phone = document.getElementById('phoneEdit').value.trim();
            currentEmployee.department = document.getElementById('departmentEdit').value;
            currentEmployee.position = document.getElementById('positionEdit').value.trim();
            currentEmployee.salary = parseFloat(document.getElementById('salaryEdit').value);
            currentEmployee.hireDate = document.getElementById('hireDateEdit').value;
            currentEmployee.isActive = document.getElementById('statusEdit').checked;

            // Find and update in employees array
            const index = employees.findIndex(emp => emp.employeeId === currentEmployee.employeeId);
            if (index !== -1) {
                employees[index] = { ...currentEmployee };
            }

            // Refresh display
            displayEmployee(currentEmployee);
            showUpdateMessage('Employee information updated successfully!', 'success');
        }

        function cancelEdit() {
            if (currentEmployee) {
                displayEmployee(currentEmployee);
                hideUpdateMessage();
            }
        }

        function validateInput() {
            const firstName = document.getElementById('firstNameEdit').value.trim();
            const lastName = document.getElementById('lastNameEdit').value.trim();
            const email = document.getElementById('emailEdit').value.trim();
            const position = document.getElementById('positionEdit').value.trim();
            const salary = parseFloat(document.getElementById('salaryEdit').value);

            if (!firstName || !lastName || !email || !position) {
                showUpdateMessage('Please fill in all required fields (First Name, Last Name, Email, Position).', 'warning');
                return false;
            }

            if (isNaN(salary) || salary < 0) {
                showUpdateMessage('Please enter a valid salary amount.', 'warning');
                return false;
            }

            return true;
        }

        function clearSearch() {
            document.getElementById('txtSearchEmployeeId').value = '';
            document.getElementById('employeeDetails').style.display = 'none';
            hideSearchMessage();
            hideUpdateMessage();
            currentEmployee = null;
            isEditMode = false;
        }

        function showSearchMessage(message, type) {
            document.getElementById('searchMessageText').textContent = message;
            document.getElementById('searchMessage').className = `alert alert-${type} mt-3`;
            document.getElementById('searchMessage').style.display = 'block';
        }

        function hideSearchMessage() {
            document.getElementById('searchMessage').style.display = 'none';
        }

        function showUpdateMessage(message, type) {
            document.getElementById('updateMessageText').textContent = message;
            document.getElementById('updateMessage').className = `alert alert-${type}`;
            document.getElementById('updateMessage').style.display = 'block';
            
            setTimeout(() => {
                hideUpdateMessage();
            }, 3000);
        }

        function hideUpdateMessage() {
            document.getElementById('updateMessage').style.display = 'none';
        }

        function changeTheme() {
            const themes = ['Default', 'HR', 'IT', 'Finance', 'Marketing'];
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            
            const themeSelection = prompt(
                'Select theme:\n1. Default (Blue)\n2. HR (Green)\n3. IT (Purple)\n4. Finance (Orange)\n5. Marketing (Pink)\n\nYour choice (1-5):',
                '1'
            );
            
            if (themeSelection && themeSelection >= 1 && themeSelection <= 5) {
                const selectedTheme = themes[themeSelection - 1];
                currentUser.selectedTheme = selectedTheme;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                applyTheme(selectedTheme);
                alert('Theme changed: ' + selectedTheme);
            }
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('currentUser');
                window.location.href = 'index.html';
            }
        }

        // Enter key support for search
        document.getElementById('txtSearchEmployeeId').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchEmployee();
            }
        });
    </script>
</body>
</html>